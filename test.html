<!DOCTYPE html>

<html>
    <head>
        <title>Audio test</title>
        <script type="text/javascript" src="js/stopwatch.js"></script>
        <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen"/>
        <link href="main.css" rel="stylesheet" media="screen"/>
        <script src="js/jquery-1.10.2.min.js"></script>
        <script src="bootstrap/js/bootstrap.min.js"></script>

    </head>

    <body>
    <div class="container">
        <div id="watchText">Time to next break:</div>
        <div id="watchDisplay">00:00:10</div>
    </div>
        <script>
            window.w = new Stopwatch(function(watch) {
                // Listener function
                document.getElementById('watchDisplay').innerHTML = watch.toString()
            } , 1000, false);

            /* When normalPeriod is 'true', the user can carry on his tasks on computer, but when it
             * is 'false', we'll alert the user to not look at the screen and relax eyes. */
            window.normalPeriod = true;
            window.normalPeriodLength = 1000 * 60 * 20;    // 20 minutes
            window.relaxPeriodLength = 1000 * 20;          // 20 seconds

            window.soundFile1 = "bing.mp3";
            window.soundFile2 = "bong.mp3";



            //temporary values
            normalPeriodLength = 1000 * 10;
            relaxPeriodLength = 1000 * 2;

            var watchTextValues = ["Time to next break:", "Don't look at the screen!!"];

            setInterval('loop(window.w)', normalPeriodLength);
            window.w.setElapsed(0, 00, 10);
            window.w.start();

            function loop(watch) {
                resetWatch(watch, window.normalPeriodLength);
                playTwoSoundsWithDelay();
//                toggleWatchText();
            }

            function toggleWatchText() {
                var textValue = document.getElementById('watchText').innerHTML;
//                if textValue.substr(1,1) = "Don't look at the screen!!";
            }
            function resetWatch(watch, timeMilliSec) {
                watch.stop();
                watch.setElapsed(0,0,timeMilliSec/1000);
                watch.start();
                document.getElementById('watchDisplay').innerHTML = watch.toString();
            }

            function playSound(filename){
                var sound=new Audio(filename);
                sound.play();
            }

            function playTwoSoundsWithDelay() {
                // Plays the first sound immediately, and the other after 'delay' milliseconds
                playSound(window.soundFile1);
                resetWatch(window.w, window.relaxPeriodLength);
                setTimeout(function(){
                    playSound(window.soundFile2);
                    resetWatch(window.w, window.normalPeriodLength - window.relaxPeriodLength)
                }, window.relaxPeriodLength);
            }


        </script>
    </body>
</html>
